package com.velvetvictory.serviceImpl;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.velvetvictory.dto.request.CustomerRequest;
import com.velvetvictory.models.Customer;
import com.velvetvictory.repository.CustomerRepository;
import com.velvetvictory.service.CustomerService;

@Service
public class CustomerServiceImpl implements CustomerService{
	
	@Autowired
	private CustomerRepository customerRepository;

	@Override
	public Object addCustomer(CustomerRequest customerRequest)
	{
		
		if(customerRequest != null)
		{
			Customer customer = new Customer();
			
			customer.setId(customerRequest.getId());
			customer.setFirstName(customerRequest.getFirstName());
			customer.setLastName(customerRequest.getLastName());
			customer.setEmail(customerRequest.getEmail());
			customer.setPassword(customerRequest.getPassword());
			customer.setContact(customerRequest.getContact());
			customer.setRole(customerRequest.getRole());
			
			customerRepository.save(customer);
			return "Customer Registration Successfull..";
		}
		else
		{
			return "Customer Registration Not Successfull..";
		}
	}
	

    public void sendEmailWithTemplate(String to, String subject, Context context) throws MessagingException {
        MimeMessage mimeMessage = javaMailSender.createMimeMessage();
        MimeMessageHelper mimeMessageHelper = new MimeMessageHelper(mimeMessage, true, "utf-8");

        mimeMessageHelper.setFrom(fromEmail);
        mimeMessageHelper.setTo(to);
        mimeMessageHelper.setSubject(subject);

        String htmlContent = templateEngine.process("emailTemplate", context);
        mimeMessageHelper.setText(htmlContent,true);

        javaMailSender.send(mimeMessage);

    }

}
